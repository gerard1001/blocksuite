import{A as G,Z as F,D as K,d as $,p as m,g as Y,v as Z,a as j,c as R,M as w,b as B}from"./main-DB6NgvzI.js";import{T as r,S as q,B as z,n as O,a as J,e as Q,b as U,c as W}from"./chunk.URTPIBTY-BfW3KnjQ.js";import"./browser-CRWZJX63.js";async function D(t,n){const o=t.createDoc(n);o.load();const a=o.getStore(),e=a.addBlock("affine:page",{title:new r("Affine Snapshot Test")});a.addBlock("affine:surface",{},e);const i=await(await fetch("/apps/starter/data/snapshots/affine-default.zip")).blob(),c=new q;c.register(G),await F.importDocs(t,c,i)}D.id="affine-snapshot";D.displayName="Affine Snapshot Test";D.description="Affine Snapshot Test";const x=(t,n)=>{const o=t.createDoc(n),a=o.getStore();o.load(()=>{const e=a.addBlock("affine:page",{title:new r("BlockSuite Playground")});a.addBlock("affine:surface",{},e);const d=a.addBlock("affine:note",{},e),s=a.addBlock("affine:paragraph",{},d);if(!a.getModelById(s))throw new Error("model is not found");const c=(l,f=!0)=>{var p;const h=a.addBlock("affine:database",{columns:[],cells:{}},d),b=a.getModelById(h),k=new K(b);k.viewManager.viewAdd("table"),b.props.title=new r(l);const y=k.propertyAdd("end",{type:$.richTextColumnConfig.type,name:"Rich Text"});if(Object.values([m.multiSelectPropertyConfig,m.datePropertyConfig,m.numberPropertyConfig,$.linkColumnConfig,m.checkboxPropertyConfig,m.progressPropertyConfig]).forEach(g=>{k.propertyAdd("end",{type:g.type,name:g.config.name})}),f){const g=(p=k.viewManager.currentView$.value)==null?void 0:p.traitGet(Y);g?.changeGroup(b.props.columns[1].id)}["text","quote","h1","h2","h3","h4","h5","h6"].forEach(g=>{const I=a.addBlock("affine:paragraph",{type:g,text:new r(`Paragraph type ${g}`)},h);y&&k.cellValueChange(I,y,new r(`Paragraph type ${g}`))}),["numbered","bulleted","todo","toggle"].forEach(g=>{const I=a.addBlock("affine:list",{type:g,text:new r(`List type ${g}`)},h);y&&k.cellValueChange(I,y,new r(`List type ${g}`))}),a.addBlock("affine:paragraph",{},d),a.addBlock("affine:paragraph",{},d),a.addBlock("affine:paragraph",{},d),a.addBlock("affine:paragraph",{},d),a.addBlock("affine:paragraph",{},d),k.viewManager.viewAdd(Z.kanbanViewMeta.type),a.resetHistory()};c("Database 1",!1),c("Database 2"),c("Database 3"),c("Database 4"),c("Database 5"),c("Database 6"),c("Database 7"),c("Database 8"),c("Database 9"),c("Database 10")})};x.id="database";x.displayName="Database Example";x.description="Database block basic example";const v=(t,n)=>{var o;const a=(o=t.getDoc(n))!=null?o:t.createDoc(n),e=a.getStore();a.clear(),a.load(()=>{const d=e.addBlock("affine:page",{title:new r}),s=e.addBlock("affine:surface",{},d),i=e.addBlock("affine:note",{},d);e.addBlock("affine:paragraph",{},i),e.addBlock("affine:embed-github",{url:"https://github.com/toeverything/AFFiNE/pull/5453"},i),e.addBlock("affine:embed-github",{url:"https://www.github.com/toeverything/blocksuite/pull/5927",style:"vertical",xywh:"[0, 400, 364, 390]"},s),e.addBlock("affine:embed-github",{url:"https://github.com/Milkdown/milkdown/pull/1215",xywh:"[500, 400, 752, 116]"},s),e.addBlock("affine:paragraph",{},i)}),e.resetHistory()};v.id="embed";v.displayName="Example for embed blocks";v.description="Example for embed blocks";const M=(t,n)=>{var o;const a=(o=t.getDoc(n))!=null?o:t.createDoc(n),e=a.getStore();a.clear(),a.load(()=>{const d=e.addBlock("affine:page",{title:new r});e.addBlock("affine:surface",{},d);const s=e.addBlock("affine:note",{},d);e.addBlock("affine:paragraph",{},s)}),e.resetHistory()};M.id="empty";M.displayName="Empty Editor";M.description="Start from empty editor";const X=new URLSearchParams(location.search),E=(t,n)=>{const o=Number(X.get("count"))||1e3,a=t.createDoc(n),e=a.getStore();a.load(()=>{const d=e.addBlock("affine:page",{title:new r});e.addBlock("affine:surface",{},d);const s=e.addBlock("affine:note",{},d);for(let i=0;i<o;i++)e.addBlock("affine:paragraph",{text:new r("Hello, world! "+i)},s)})};E.id="heavy";E.displayName="Heavy Example";E.description="Heavy example on thousands of paragraph blocks";const ee=["rect","triangle","ellipse","diamond"],L=new URLSearchParams(location.search);function ae(t){const n={};for(let o=0;o<t;o++){const a=Math.random()*t*2,e=Math.random()*t*2,d=J();n[d]=O({id:d,index:"a0",type:"shape",xywh:`[${a},${e},100,100]`,seed:Math.floor(Math.random()*2**31),shapeType:ee[Math.floor(Math.random()*40)%4],radius:0,filled:!1,fillColor:"--affine-palette-shape-yellow",strokeWidth:4,strokeColor:"--affine-palette-line-yellow",strokeStyle:"solid",roughness:j},{deep:!1})}return n}const oe=100,u=2e3,T=(t,n)=>{const o=Number(L.get("count"))||oe,a=!!L.get("shapes"),e=t.createDoc(n),d=e.getStore();e.load(()=>{const s=d.addBlock("affine:page",{title:new r}),i=a?ae(o):{};d.addBlock("affine:surface",{elements:new z(O(i,{deep:!1}))},s);let c=0;for(c=0;c<o;c++){const l=Math.random()*u-u/2,f=Math.random()*u-u/2,p=d.addBlock("affine:note",{xywh:`[${l}, ${f}, 100, 50]`},s);d.addBlock("affine:paragraph",{text:new r("Note #"+c)},p)}})};T.id="heavy-whiteboard";T.displayName="Heavy Whiteboard";T.description="Heavy Whiteboard on 200 elements by default";const P=(t,n)=>{var o,a;const e=(a=(o=t.getDoc(n))==null?void 0:o.getStore({id:n}))!=null?a:t.createDoc(n).getStore({id:n}),d="doc:linked-page",s=t.createDoc(d).getStore(),i="doc:linked-edgeless",c=t.createDoc(i).getStore();e.doc.clear(),s.doc.clear(),c.doc.clear(),s.load(()=>{const p=s.addBlock("affine:page",{title:new r("")});s.addBlock("affine:surface",{},p);const h=s.addBlock("affine:note",{},p);s.addBlock("affine:paragraph",{},h)}),c.load(()=>{const p=c.addBlock("affine:page",{title:new r("")});c.addBlock("affine:surface",{},p);const h=c.addBlock("affine:note",{},p);c.addBlock("affine:paragraph",{},h)}),e.load();const l=e.addBlock("affine:page",{title:new r("Doc A")});e.addBlock("affine:surface",{},l);const f=e.addBlock("affine:note",{},l);e.addBlock("affine:paragraph",{},f),e.addBlock("affine:embed-linked-doc",{pageId:d},f),e.addBlock("affine:embed-linked-doc",{pageId:"doc:deleted-example"},f),e.addBlock("affine:embed-linked-doc",{pageId:i},f),e.addBlock("affine:embed-linked-doc",{pageId:"doc:deleted-example-edgeless"},f),e.resetHistory(),s.resetHistory(),c.resetHistory()};P.id="linked";P.displayName="Linked Doc Editor";P.description="A demo with linked docs";const H=(t,n)=>{const o=t.createDoc(n).getStore({id:n});o.load(()=>{const e=o.addBlock("affine:page",{title:new r});o.addBlock("affine:surface",{},e);const d=o.addBlock("affine:note",{},e);o.addBlock("affine:paragraph",{},d)}),o.resetHistory();const a=document.getElementById("app");if(a){const e=R(o,t);e.style.borderRight="1px solid var(--affine-border-color)",a.append(e),a.style.display="flex"}};H.id="multiple-editor";H.displayName="Multiple Editor Example";H.description="Multiple Editor basic example";const N=(t,n)=>{const o=t.createDoc(n).getStore();o.load(()=>{const e=o.addBlock("affine:page",{title:new r});o.addBlock("affine:surface",{},e);const d=o.addBlock("affine:note",{},e);o.addBlock("affine:paragraph",{},d)}),o.resetHistory();const a=document.getElementById("app");if(a){const e=R(o,t);e.style.borderBottom="1px solid var(--affine-border-color)",a.append(e),a.style.display="flex",a.style.flexDirection="column"}};N.id="multiple-editor-vertical";N.displayName="Vertical Multiple Editor Example";N.description="Multiple Editor vertical layout example";const A=(t,n)=>{const o=t.createDoc(n).getStore({id:n}),a=t.createDoc("tempDoc").getStore();o.load(),a.load(()=>{const e=a.addBlock("affine:page",{title:new r("Pending Structs")}),d=Q(a.spaceDoc);a.addBlock("affine:surface",{},e);const s=a.addBlock("affine:note",{},e);a.addBlock("affine:paragraph",{text:new r("This is a paragraph block")},s);const i=U(a.spaceDoc,d);W(o.spaceDoc,i)})};A.id="pending-structs";A.displayName="Pending Structs";A.description="Doc with pending structs";const te="Click the ðŸ” button to switch between editors dynamically - they are fully compatible!",C=async(t,n)=>{let o=t.getDoc(n);const a=!!o;o||(o=t.createDoc(n));const e=o.getStore({id:n});e.load();let d;if(!a){const s=e.addBlock("affine:page",{title:new r("BlockSuite Playground")});e.addBlock("affine:surface",{},s),d=e.addBlock("affine:note",{xywh:"[0, 100, 800, 640]"},s),await w.importMarkdownToBlock({doc:e,blockId:d,markdown:te,extensions:B().get("store")})}e.resetHistory()};C.id="preset";C.displayName="BlockSuite Starter";C.description="Start from friendly introduction";const S=`We share some of our findings from developing local-first software prototypes at [Ink & Switch](https://www.inkandswitch.com/) over the course of several years. These experiments test the viability of CRDTs in practice, and explore the user interface challenges for this new data model. Lastly, we suggest some next steps for moving towards local-first software: for researchers, for app developers, and a startup opportunity for entrepreneurs.

This article has also been published [in PDF format](https://www.inkandswitch.com/local-first/static/local-first.pdf) in the proceedings of the [Onward! 2019 conference](https://2019.splashcon.org/track/splash-2019-Onward-Essays). Please cite it as:

> Martin Kleppmann, Adam Wiggins, Peter van Hardenberg, and Mark McGranaghan. Local-first software: you own your data, in spite of the cloud. 2019 ACM SIGPLAN International Symposium on New Ideas, New Paradigms, and Reflections on Programming and Software (Onward!), October 2019, pages 154-178. [doi:10.1145/3359591.3359737](https://doi.org/10.1145/3359591.3359737)

We welcome your feedback: [@inkandswitch](https://twitter.com/inkandswitch) or hello@inkandswitch.com.`,V=(t,n)=>{var o,a;const e=(a=(o=t.getDoc(n))==null?void 0:o.getStore({id:n}))!=null?a:t.createDoc(n).getStore({id:n}),d="doc:synced-page",s=t.createDoc(d).getStore(),i="doc:synced-edgeless",c=t.createDoc(i).getStore();e.doc.clear(),s.doc.clear(),c.doc.clear(),s.load(()=>{const l=s.addBlock("affine:page",{title:new r("Synced - Page View")});s.addBlock("affine:surface",{},l);const f=s.addBlock("affine:note",{},l);w.importMarkdownToBlock({doc:s,blockId:f,markdown:S,extensions:B().get("store")}).catch(console.error)}),c.load(()=>{const l=c.addBlock("affine:page",{title:new r("Synced - Edgeless View")});c.addBlock("affine:surface",{},l);const f=c.addBlock("affine:note",{},l);w.importMarkdownToBlock({doc:c,blockId:f,markdown:S,extensions:B().get("store")}).catch(console.error)}),e.load(()=>{const l=e.addBlock("affine:page",{title:new r("Home doc, having synced blocks")}),f=e.addBlock("affine:surface",{},l),p=e.addBlock("affine:note",{},l);w.importMarkdownToBlock({doc:e,blockId:p,markdown:S,extensions:B().get("store")}).then(()=>{e.addBlock("affine:paragraph",{text:new r("Cyclic / Matryoshka synced block ðŸ‘‡"),type:"h4"},p),e.addBlock("affine:embed-synced-doc",{pageId:n},p),e.addBlock("affine:embed-synced-doc",{pageId:d},p),e.addBlock("affine:embed-synced-doc",{pageId:i},p),e.addBlock("affine:embed-synced-doc",{pageId:d,xywh:"[-1000, 0, 752, 455]"},f),e.addBlock("affine:embed-synced-doc",{pageId:i,xywh:"[-1000, 500, 752, 455]"},f),e.addBlock("affine:embed-synced-doc",{pageId:n,xywh:"[-1000, 1000, 752, 455]"},f),e.addBlock("affine:embed-synced-doc",{pageId:"doc:deleted-page"},p)}).catch(console.error)}),c.resetHistory(),s.resetHistory(),e.resetHistory()};V.id="synced";V.displayName="Synced block demo";V.description="A simple demo for synced block";const _=(t,n)=>{const o=t.createDoc(n).getStore({id:n}),a=t.createDoc("tempDoc").getStore();o.load(),a.load(()=>{const e=a.addBlock("affine:page",{});a.addBlock("affine:surface",{},e);const d=a.addBlock("affine:note",{xywh:"[0, 100, 800, 640]"},e),s=a.addBlock("affine:paragraph",{},d),c=a.spaceDoc.get("blocks").get(s);c.set("sys:version",c.get("sys:version")+1);const l=U(a.spaceDoc);W(o.spaceDoc,l),o.addBlock("affine:paragraph",{},d)}),t.removeDoc("tempDoc"),o.resetHistory()};_.id="version-mismatch";_.displayName="Version Mismatch";_.description="Error boundary when version mismatch in data";export{D as affineSnapshot,x as database,v as embed,M as empty,E as heavy,T as heavyWhiteboard,P as linked,H as multiEditor,N as multiEditorVertical,A as pendingStructs,C as preset,V as synced,_ as versionMismatch};
//# sourceMappingURL=index-DrDgyqM3.js.map
