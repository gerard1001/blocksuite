{"version":3,"file":"inline-jPhJlPwn.js","sources":["../../../examples/inline/test-page.ts"],"sourcesContent":["import '@shoelace-style/shoelace';\n\nimport { ShadowlessElement } from '@blocksuite/affine/std';\nimport { effects } from '@blocksuite/affine/std/effects';\nimport {\n  type AttributeRenderer,\n  InlineEditor,\n  ZERO_WIDTH_FOR_EMBED_NODE,\n} from '@blocksuite/affine/std/inline';\nimport {\n  type BaseTextAttributes,\n  baseTextAttributes,\n} from '@blocksuite/affine/store';\nimport { effect } from '@preact/signals-core';\nimport { css, html, nothing } from 'lit';\nimport { customElement, property, query } from 'lit/decorators.js';\nimport { styleMap } from 'lit/directives/style-map.js';\nimport * as Y from 'yjs';\nimport { z } from 'zod';\n\neffects();\n\nfunction inlineTextStyles(\n  props: BaseTextAttributes\n): ReturnType<typeof styleMap> {\n  let textDecorations = '';\n  if (props.underline) {\n    textDecorations += 'underline';\n  }\n  if (props.strike) {\n    textDecorations += ' line-through';\n  }\n\n  let inlineCodeStyle = {};\n  if (props.code) {\n    inlineCodeStyle = {\n      'font-family':\n        '\"SFMono-Regular\", Menlo, Consolas, \"PT Mono\", \"Liberation Mono\", Courier, monospace',\n      'line-height': 'normal',\n      background: 'rgba(135,131,120,0.15)',\n      color: '#EB5757',\n      'border-radius': '3px',\n      'font-size': '85%',\n      padding: '0.2em 0.4em',\n    };\n  }\n\n  return styleMap({\n    'font-weight': props.bold ? 'bold' : 'normal',\n    'font-style': props.italic ? 'italic' : 'normal',\n    'text-decoration': textDecorations.length > 0 ? textDecorations : 'none',\n    ...inlineCodeStyle,\n  });\n}\n\nconst attributeRenderer: AttributeRenderer = ({ delta, selected }) => {\n  // @ts-expect-error ignore\n  if (delta.attributes?.embed) {\n    return html`<span\n      style=${styleMap({\n        padding: '0 0.4em',\n        border: selected ? '1px solid #eb763a' : '',\n        background: 'rgba(135,131,120,0.15)',\n      })}\n      >@flrande<v-text .str=${ZERO_WIDTH_FOR_EMBED_NODE}></v-text\n    ></span>`;\n  }\n\n  const style = delta.attributes\n    ? inlineTextStyles(delta.attributes)\n    : styleMap({});\n\n  return html`<span style=${style}\n    ><v-text .str=${delta.insert}></v-text\n  ></span>`;\n};\n\nfunction toggleStyle(\n  inlineEditor: InlineEditor,\n  attrs: NonNullable<BaseTextAttributes>\n): void {\n  const inlineRange = inlineEditor.getInlineRange();\n  if (!inlineRange) {\n    return;\n  }\n\n  const root = inlineEditor.rootElement;\n  if (!root) {\n    return;\n  }\n\n  const deltas = inlineEditor.getDeltasByInlineRange(inlineRange);\n  let oldAttributes: NonNullable<BaseTextAttributes> = {};\n\n  for (const [delta] of deltas) {\n    const attributes = delta.attributes;\n\n    if (!attributes) {\n      continue;\n    }\n\n    oldAttributes = { ...attributes };\n  }\n\n  const newAttributes = Object.fromEntries(\n    Object.entries(attrs).map(([k, v]) => {\n      if (\n        typeof v === 'boolean' &&\n        v === (oldAttributes as Record<string, unknown>)[k]\n      ) {\n        return [k, null];\n      } else {\n        return [k, v];\n      }\n    })\n  );\n\n  inlineEditor.formatText(inlineRange, newAttributes, {\n    mode: 'merge',\n  });\n  root.blur();\n\n  inlineEditor.setInlineRange(inlineRange);\n}\n\n@customElement('test-rich-text')\nexport class TestRichText extends ShadowlessElement {\n  override firstUpdated() {\n    this.contentEditable = 'true';\n    this.style.outline = 'none';\n    this.inlineEditor.mount(this._container, this);\n\n    this.inlineEditor.slots.textChange.subscribe(() => {\n      const el = this.querySelector('.y-text');\n      if (el) {\n        const text = this.inlineEditor.yText.toDelta();\n        const span = document.createElement('span');\n        span.innerHTML = JSON.stringify(text);\n        el.replaceChildren(span);\n      }\n    });\n    effect(() => {\n      const inlineRange = this.inlineEditor.inlineRange$.value;\n      const el = this.querySelector('.v-range');\n      if (el && inlineRange) {\n        const span = document.createElement('span');\n        span.innerHTML = JSON.stringify(inlineRange);\n        el.replaceChildren(span);\n      }\n    });\n  }\n\n  override render() {\n    return html`<style>\n        test-rich-text {\n          display: grid;\n          grid-template-rows: minmax(0, 3fr) minmax(0, 1fr) minmax(0, 1fr);\n          grid-template-columns: minmax(0, 1fr);\n          width: 100%;\n        }\n\n        .rich-text-container {\n          outline: none;\n        }\n\n        code {\n          font-family:\n            'SFMono-Regular', Menlo, Consolas, 'PT Mono', 'Liberation Mono',\n            Courier, monospace;\n          line-height: normal;\n          background: rgba(135, 131, 120, 0.15);\n          color: #eb5757;\n          border-radius: 3px;\n          font-size: 85%;\n          padding: 0.2em 0.4em;\n        }\n\n        .v-range,\n        .y-text {\n          font-family:\n            'SFMono-Regular', Menlo, Consolas, 'PT Mono', 'Liberation Mono',\n            Courier, monospace;\n          line-height: normal;\n          background: rgba(135, 131, 120, 0.15);\n        }\n\n        .v-range,\n        .y-text > span {\n          display: block;\n          word-wrap: break-word;\n        }\n      </style>\n      <div class=\"rich-text-container\"></div>\n      <div contenteditable=\"false\" class=\"v-range\"></div>\n      <div contenteditable=\"false\" class=\"y-text\"></div>`;\n  }\n\n  @query('.rich-text-container')\n  private accessor _container!: HTMLDivElement;\n\n  @property({ attribute: false })\n  accessor inlineEditor!: InlineEditor;\n\n  @property({ attribute: false })\n  accessor undoManager!: Y.UndoManager;\n}\n\nconst TEXT_ID = 'inline-editor';\nconst yDocA = new Y.Doc();\nconst yDocB = new Y.Doc();\n\nyDocA.on('update', update => {\n  Y.applyUpdate(yDocB, update);\n});\n\nyDocB.on('update', update => {\n  Y.applyUpdate(yDocA, update);\n});\n\n@customElement('custom-toolbar')\nexport class CustomToolbar extends ShadowlessElement {\n  static override styles = css`\n    .custom-toolbar {\n      display: grid;\n      grid-template-columns: repeat(4, minmax(0, 1fr));\n      grid-template-rows: repeat(2, minmax(0, 1fr));\n    }\n  `;\n\n  override connectedCallback() {\n    super.connectedCallback();\n    this.addEventListener('pointerdown', e => {\n      e.preventDefault();\n    });\n  }\n\n  override firstUpdated() {\n    const boldButton = this.querySelector('.bold');\n    const italicButton = this.querySelector('.italic');\n    const underlineButton = this.querySelector('.underline');\n    const strikeButton = this.querySelector('.strike');\n    const code = this.querySelector('.code');\n    const embed = this.querySelector('.embed');\n    const resetButton = this.querySelector('.reset');\n    const undoButton = this.querySelector('.undo');\n    const redoButton = this.querySelector('.redo');\n\n    if (\n      !boldButton ||\n      !italicButton ||\n      !underlineButton ||\n      !strikeButton ||\n      !code ||\n      !embed ||\n      !resetButton ||\n      !undoButton ||\n      !redoButton\n    ) {\n      throw new Error('Cannot find button');\n    }\n\n    const undoManager = new Y.UndoManager(this.inlineEditor.yText, {\n      trackedOrigins: new Set([this.inlineEditor.yText.doc?.clientID]),\n    });\n\n    addEventListener('keydown', e => {\n      if (\n        e instanceof KeyboardEvent &&\n        (e.ctrlKey || e.metaKey) &&\n        e.key === 'z'\n      ) {\n        e.preventDefault();\n        if (e.shiftKey) {\n          undoManager.redo();\n        } else {\n          undoManager.undo();\n        }\n      }\n    });\n\n    undoButton.addEventListener('click', () => {\n      undoManager.undo();\n    });\n    redoButton.addEventListener('click', () => {\n      undoManager.redo();\n    });\n\n    boldButton.addEventListener('click', () => {\n      undoManager.stopCapturing();\n      toggleStyle(this.inlineEditor, { bold: true });\n    });\n    italicButton.addEventListener('click', () => {\n      undoManager.stopCapturing();\n      toggleStyle(this.inlineEditor, { italic: true });\n    });\n    underlineButton.addEventListener('click', () => {\n      undoManager.stopCapturing();\n      toggleStyle(this.inlineEditor, { underline: true });\n    });\n    strikeButton.addEventListener('click', () => {\n      undoManager.stopCapturing();\n      toggleStyle(this.inlineEditor, { strike: true });\n    });\n    code.addEventListener('click', () => {\n      undoManager.stopCapturing();\n      toggleStyle(this.inlineEditor, { code: true });\n    });\n    embed.addEventListener('click', () => {\n      undoManager.stopCapturing();\n      // @ts-expect-error ignore\n      toggleStyle(this.inlineEditor, { embed: true });\n    });\n    resetButton.addEventListener('click', () => {\n      undoManager.stopCapturing();\n      const rangeStatic = this.inlineEditor.getInlineRange();\n      if (!rangeStatic) {\n        return;\n      }\n      this.inlineEditor.resetText(rangeStatic);\n    });\n  }\n\n  override render() {\n    return html`\n      <div class=\"custom-toolbar\">\n        <sl-button class=\"bold\">bold</sl-button>\n        <sl-button class=\"italic\">italic</sl-button>\n        <sl-button class=\"underline\">underline</sl-button>\n        <sl-button class=\"strike\">strike</sl-button>\n        <sl-button class=\"code\">code</sl-button>\n        <sl-button class=\"embed\">embed</sl-button>\n        <sl-button class=\"reset\">reset</sl-button>\n        <sl-button class=\"undo\">undo</sl-button>\n        <sl-button class=\"redo\">redo</sl-button>\n      </div>\n    `;\n  }\n\n  @property({ attribute: false })\n  accessor inlineEditor!: InlineEditor;\n\n  @property({ attribute: false })\n  accessor undoManager!: Y.UndoManager;\n}\n\n@customElement('test-page')\nexport class TestPage extends ShadowlessElement {\n  static override styles = css`\n    .container {\n      display: grid;\n      height: 100vh;\n      width: 100vw;\n      justify-content: center;\n      align-items: center;\n    }\n\n    .editors {\n      display: grid;\n      grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);\n      padding: 20px;\n      background-color: #202124;\n      border-radius: 10px;\n      color: #fff;\n      grid-gap: 20px;\n    }\n\n    .editors > div {\n      height: 600px;\n      max-width: 400px;\n      display: grid;\n      grid-template-rows: 150px minmax(0, 1fr);\n      grid-template-columns: minmax(0, 1fr);\n      overflow-y: scroll;\n    }\n  `;\n\n  private _editorA: InlineEditor | null = null;\n\n  private _editorB: InlineEditor | null = null;\n\n  private _undoManagerA: Y.UndoManager | null = null;\n\n  private _undoManagerB: Y.UndoManager | null = null;\n\n  override firstUpdated() {\n    const textA = yDocA.getText(TEXT_ID);\n    this._editorA = new InlineEditor<\n      BaseTextAttributes & {\n        embed?: true;\n      }\n    >(textA, {\n      isEmbed: delta => !!delta.attributes?.embed,\n    });\n    this._editorA.setAttributeSchema(\n      baseTextAttributes.extend({\n        embed: z.literal(true).optional().catch(undefined),\n      })\n    );\n    this._editorA.setAttributeRenderer(attributeRenderer);\n    this._undoManagerA = new Y.UndoManager(textA, {\n      trackedOrigins: new Set([textA.doc?.clientID]),\n    });\n\n    const textB = yDocB.getText(TEXT_ID);\n    this._editorB = new InlineEditor(textB);\n    this._undoManagerB = new Y.UndoManager(textB, {\n      trackedOrigins: new Set([textB.doc?.clientID]),\n    });\n\n    this.requestUpdate();\n  }\n\n  override render() {\n    if (!this._editorA) {\n      return nothing;\n    }\n\n    return html`\n      <div class=\"container\">\n        <div class=\"editors\">\n          <div class=\"doc-a\">\n            <custom-toolbar\n              .inlineEditor=${this._editorA}\n              .undoManager=${this._undoManagerA}\n            ></custom-toolbar>\n            <test-rich-text\n              .inlineEditor=${this._editorA}\n              .undoManager=${this._undoManagerA!}\n            ></test-rich-text>\n          </div>\n          <div class=\"doc-b\">\n            <custom-toolbar\n              .inlineEditor=${this._editorB}\n              .undoManager=${this._undoManagerB!}\n            ></custom-toolbar>\n            <test-rich-text\n              .inlineEditor=${this._editorB}\n              .undoManager=${this._undoManagerB}\n            ></test-rich-text>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n}\n"],"names":["_undoManager_dec","_inlineEditor_dec","__container_dec","_a","_TestRichText_decorators","_init","__container","_inlineEditor","_undoManager","_b","_CustomToolbar_decorators","_TestPage_decorators","_c","effects","inlineTextStyles","props","textDecorations","inlineCodeStyle","styleMap","attributeRenderer","delta","selected","html","ZERO_WIDTH_FOR_EMBED_NODE","style","toggleStyle","inlineEditor","attrs","inlineRange","root","deltas","oldAttributes","attributes","newAttributes","k","v","customElement","TestRichText","query","property","__privateAdd","__runInitializers","el","text","span","effect","__decoratorStart","__decorateElement","TEXT_ID","yDocA","Y.Doc","yDocB","update","Y.applyUpdate","CustomToolbar","e","boldButton","italicButton","underlineButton","strikeButton","code","embed","resetButton","undoButton","redoButton","undoManager","Y.UndoManager","rangeStatic","css","TestPage","ShadowlessElement","textA","InlineEditor","baseTextAttributes","z.literal","textB","nothing"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}